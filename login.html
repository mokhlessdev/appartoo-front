<!DOCTYPE html>
<html lang="en">
    <head> 
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" type="text/css" href="assets/css/bootstrap.css">

		<!-- Website CSS style -->
		<link rel="stylesheet" type="text/css" href="assets/css/main.css">

		<!-- Website Font style -->
	    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
		
		<!-- Google Fonts -->
		<link href='https://fonts.googleapis.com/css?family=Passion+One' rel='stylesheet' type='text/css'>
		<link href='https://fonts.googleapis.com/css?family=Oxygen' rel='stylesheet' type='text/css'>
<style type="text/css">
	/*
/* Created by Filipe Pina
 * Specific styles of signin, register, component
 */
/*
 * General styles
 */

body, html{
     height: 100%;
 	background-repeat: no-repeat;
 	background-color: #d3d3d3;
 	font-family: 'Oxygen', sans-serif;
}

.main{
 	margin-top: 70px;
}

h1.title { 
	font-size: 50px;
	font-family: 'Passion One', cursive; 
	font-weight: 400; 
}

hr{
	width: 10%;
	color: #fff;
}

.form-group{
	margin-bottom: 15px;
}

label{
	margin-bottom: 15px;
}

input,
input::-webkit-input-placeholder {
    font-size: 11px;
    padding-top: 3px;
}

.main-login{
 	background-color: #fff;
    /* shadows and rounded borders */
    -moz-border-radius: 2px;
    -webkit-border-radius: 2px;
    border-radius: 2px;
    -moz-box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);
    -webkit-box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);
    box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);

}

.main-center{
 	margin-top: 30px;
 	margin: 0 auto;
 	max-width: 330px;
    padding: 40px 40px;

}

.login-button{
	margin-top: 5px;
}

.login-register{
	font-size: 11px;
	text-align: center;
}

</style>
		<title>Admin</title>
	</head>
	<body>

		<div class="container" ng-app="Marsupilami" ng-controller="Marsupilami" >

      <

<a href="#!index">Mon profile</a>
<a href="#!register">Inscription</a>

			<div class="row main">
				<div class="panel-heading">
	               <div class="panel-title text-center">
	               		<h1 class="title">Company Name</h1>
	               		<hr />
	               	</div>
	            </div> 
				<div class="main-login main-center">
					<form class="form-horizontal" method="post" action="#">
						
				

						<div class="form-group">
							<label for="username" class="cols-sm-2 control-label">Username</label>
							<div class="cols-sm-10">
								<div class="input-group">
									<span class="input-group-addon"><i class="fa fa-users fa" aria-hidden="true"></i></span>
									<input type="text" class="form-control" name="username" id="username"  placeholder="Enter your Username" ng-model="user.username"/>
								</div>
							</div>
						</div>

						<div class="form-group">
							<label for="password" class="cols-sm-2 control-label">Password</label>
							<div class="cols-sm-10">
								<div class="input-group">
									<span class="input-group-addon"><i class="fa fa-lock fa-lg" aria-hidden="true"></i></span>
									<input type="password" class="form-control" name="password" id="password" ng-model="user.password" placeholder="Enter your Password"/>
								</div>
							</div>
						</div>


						<div class="form-group ">
							<button type="button" ng-click="login()" class="btn btn-primary btn-lg btn-block login-button">Login</button>
						</div>
						<div class="login-register">
				            <a href="index.php">Register</a>
				         </div>
					</form>
				</div>
			</div>
		</div>

		<script type="text/javascript" src="assets/js/bootstrap.js"></script>

     <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.6/angular.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.6/angular-route.min.js" type="text/javascript"></script>

      <script src="assets/js/angular-resource.js"></script>

<script src="bower_components/angular-cookies/angular-cookies.min.js"></script>
<script src="bower_components/query-string/query-string.js"></script>
<script src="bower_components/angular-oauth2/dist/angular-oauth2.min.js"></script>

    <script>
                    var app = angular.module('Marsupilami', ['ngResource','angular-oauth2']);
                    app.controller('Marsupilami', function ($scope, $resource,$http) {
 $scope.token = {};
                        $scope.login = function (id)
                        {
                           console.log("login");

    var url = "http://localhost/fos-rest-and-user-bundle-integration-master/web/app_dev.php/login";

$scope.data = $scope.user;
   console.log($scope.user);
                            var postaction = $resource(url, null,
                                    {
                                        'post': {method: 'POST'}
                                    });

                            postaction.post(null, $scope.data,
                            function (data) {
                            var tokenn = data.token;
                            $scope.search(tokenn);
                            },
                                    function (error) {
                                           console.log("error");
                                    });




    };



//Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXUyJ9.eyJ1c2VySWQiOjIsInVzZXJuYW1lIjoiYWRtaW4iLCJpYXQiOiIxNTE2OTE0OTkzIn0.NMgiSMIDljDUKZnc8a2XFd32ny4ZbpGJP6E2ZE4XnScQyYL8EWsOW55Mp55MnnuA_RJp_AlwCyXr5ZMLOQ7stO3klvAARZ0pW6GjMfpuoAeF1LoEkwIzG9Es2AWpRhtsYuBT-ZVuCI4gfNpxNe_If_MR5lY_3FUUs-jPtcYr4OeofnHO8OkT0qWC2MiZgjGwFhfYagMIDQLi__EE9Hmue2oOAOScpYkam87ceLsdqYX9-VX8FtbhARa5phdjv8lOUKiESsGKzXjQu4dMjOj0FPLyiu8jwiwE7-kLuRKhrEZEFjeKq2IBiT2ed_WmyZum2s5eo1cLulwB2N057VOOT28UuQMgY3mrm92wiP9XWsm1MZ62GRz0EumNZvDDzhp6IrRy160-O_MTwhzh8eX3u77wIxDGJ2XEnuXmXRmc7foyKMIQkY55BY0e6oW766AEoiIQtXgT9WrSWkHD5YyMlb-nRoKRbVx5BGTIsBc2tsyq8O5FSG0ncEoGYe2u3XtQfCvLUVNcA73ezubLFoIxqU2mbc_yy_zhDh7DnjLViU53Rk0RI7E2hgR1nTw3TdWD0ZIP1KhP7QiJPmEz4KCUS35sbZiNHcYHiKBUFb5chQk8DvDA9gE6rtMbjkCi9T8tGdwl2nqgifwatHyjYMV1w7PWCoZYyRsLhUqpK5H1NgI




/*
   $http({
    method: 'GET', 
     url:'http://localhost/fos-rest-and-user-bundle-integration-master/web/app_dev.php/profile/admin',
    header:{
        'Authorization': $scope.token
    }
}).success(function(data) {
   console.log(data);
}).error(function(error){
    //failed.
});
*/

                    

                  
       $scope.search = function(keyword) {
        
        $scope.keyword = 't';

            var token ="Bearer "+keyword;

            var url = "http://localhost/fos-rest-and-user-bundle-integration-master/web/app_dev.php/search";
            var postaction = $resource(url, null, {
                'get': {
                    method: 'GET',
                    headers: {
                                'Authorization': token
                              },
                    params: '$scope.keyword'
                }
            });
            postaction.get({
                    'keyword': $scope.keyword
                },
                function(data) {
                    console.log(data);
                    if (data.users)
                      console.log(data);
                        $scope.searchFriends = data.users;
             
                },
                function(error) {});
        };

})
                  

  app.config(['OAuthProvider', function(OAuthProvider) {
    OAuthProvider.configure({
      baseUrl: 'http://localhost/fos-rest-and-user-bundle-integration-master/web/app_dev.php/login',
      clientId: '1_3bcbxd9e24g0gk4swg0kwgcwg4o8k8g4g888kwc44gcc0gwwk4',
      clientSecret: '4ok2x70rlfokc8g0wws8c8kwcokw80k44sg48goc0ok4w0so0k'
   

    });


  }]);

/*
  app.run(['$rootScope', '$injector', function($rootScope,$injector) {
    $injector.get("$http").defaults.transformRequest = function(data, headersGetter) {
      if (sessionService.isLogged()) {
        headersGetter()['Authorization'] = "Bearer " + sessionService.getAccessToken();
      }
      if (data) {
        return angular.toJson(data);
      }
    }
  }]);
  */

                    app.config(function ($interpolateProvider) {
                        $interpolateProvider.startSymbol('{[{').endSymbol('}]}');
                    });

     
  app.run(['OAuth', function(OAuth) {
    OAuth.configure({
     baseUrl: 'http://localhost/fos-rest-and-user-bundle-integration-master/web/app_dev.php/login',
      clientId: '1_3bcbxd9e24g0gk4swg0kwgcwg4o8k8g4g888kwc44gcc0gwwk4',
      clientSecret: '4ok2x70rlfokc8g0wws8c8kwcokw80k44sg48goc0ok4w0so0k'
    });
  }]);

/*
    app.config(function($routeProvider) {
    $routeProvider
    .when("/index", {
        templateUrl : "index.html"
    })
    .when("/login", {
        templateUrl : "login.html"
    })
    .when("/register", {
        templateUrl : "register.html"
    })
 ;
});
    */

    </script>


	</body>
</html>